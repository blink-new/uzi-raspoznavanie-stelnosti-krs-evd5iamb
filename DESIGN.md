# Архитектура Системы Распознавания Стельности КРС

Система предназначена для анализа УЗИ-видео крупного рогатого скота с целью определения стельности.

## Компоненты Системы

1.  **Фронтенд (Пользовательский Интерфейс)**:
    *   **Технология**: React (Vite).
    *   **Задачи**:
        *   Загрузка УЗИ видео пользователем.
        *   Отображение процесса анализа.
        *   Визуализация результата: "стельная" / "не стельная", процент уверенности.
        *   Просмотр истории анализов.

2.  **Бэкенд (Серверная Логика)**:
    *   **Технология**: Supabase Edge Functions (Deno/TypeScript).
    *   **Задачи**:
        *   **API-эндпоинт**: Прием видеофайла от фронтенда.
        *   **Предварительная обработка видео**: Извлечение кадров, нормализация.
        *   **Взаимодействие с AI-моделью**: Отправка кадров на AI-модель, получение предсказаний.
        *   **Агрегация результатов**: Объединение предсказаний по кадрам в общее заключение.
        *   **Отправка ответа**: Возврат финального результата на фронтенд.

3.  **AI-Модель (Искусственный Интеллект)**:
    *   **Технология**: Python с библиотеками глубокого обучения (PyTorch/TensorFlow).
    *   **Тип модели**: Сверточные нейронные сети (CNN) для анализа изображений (кадров УЗИ) или более сложные архитектуры для видео (3D CNN, CNN+LSTM, Vision Transformers).
    *   **Обучение**: Требуется большой размеченный датасет УЗИ-видео.
    *   **Развертывание**: Как отдельный API-сервис (например, Flask/FastAPI на облачной платформе). Supabase Edge Function будет обращаться к этому сервису.

4.  **База Данных (Хранилище Данных)**:
    *   **Технология**: Supabase PostgreSQL.
    *   **Задачи**:
        *   Хранение метаданных загруженных видео.
        *   Сохранение результатов и истории анализов.
        *   (Опционально) Управление пользовательскими аккаунтами.

## Схема Взаимодействия

```mermaid
graph TD
    A[Пользователь (Фронтенд React)] -- 1. Загрузка видео --> B(Бэкенд: Supabase Edge Function);
    B -- 2. Обработка видео, извлечение кадров --> C(AI-Модель: Python сервис);
    C -- 3. Предсказание (стельная/нет, уверенность) --> B;
    B -- 4. Агрегация, отправка результата --> A;
    B -- 5. Сохранение данных (опционально) --> D[База Данных: Supabase PostgreSQL];
    A -- 6. Отображение результата и истории --> A;
```

## Технологический Стек (Предпочтительный)

*   **Фронтенд**: React (Vite), Tailwind CSS, ShadCN UI.
*   **Бэкенд**: Supabase Edge Functions (Deno/TypeScript).
*   **AI-Модель**: Python, PyTorch/TensorFlow, OpenCV.
*   **База Данных**: Supabase PostgreSQL.
*   **Хостинг AI-Модели**: Облачные сервисы (Google Cloud Run, AWS Lambda, etc.) или выделенный сервер.

## Следующие Шаги по Реализации

1.  **Настройка Бэкенда**: Создание Supabase Edge Function для приема видео.
2.  **Разработка/Интеграция AI-Модели**: Обучение или поиск модели, развертывание как API.
3.  **Интеграция Фронтенда с Бэкендом**: Отправка видео, получение и отображение реальных результатов.
4.  **Работа с Базой Данных**: Создание таблиц, реализация сохранения и загрузки истории.
